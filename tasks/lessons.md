# 技術的教訓 (Lessons Learned)

## 物理演算 (Physics)

### 1. ウキの異方性減衰 (Anisotropic Damping)
円柱形のウキは、縦方向（軸方向）の抵抗は小さいが、横方向（クロスフロー）の抵抗は極めて大きい（形状抵抗）。
初期実装では等方的な線形減衰（`damping_x = damping_y`）を用いたため、微小な外力（魚のサワリ等）でいつまでも横に流れる現象が発生した。
**解決策:** 異方性減衰を導入。`damping_x = 0.1` (Strong), `damping_y = 0.0015` (Weak) とすることで、横流れを防ぎつつ縦方向の感度を維持した。

### 2. 粘性抵抗の重要性 (Linear Damping)
速度の2乗に比例する抵抗（Drag）だけでは、低速時の微小振動（Oscillation）が収束しない（0付近で力が小さすぎるため）。
水のような高粘性流体では、速度に比例する線形減衰（Stokes Drag領域）が必須である。
**解決策:** `linear_damping` を追加。ただし値は慎重に調整が必要（0.05では過減衰、0.0015が適正）。

## システム (System)

### 3. リセットロジックの落とし穴
オブジェクトを単に再生成（`new Model()`）するだけでは不十分。物理シミュレーションでは「初期位置」が安定平衡点にあることが前提の場合が多い。
デフォルト座標 `(0,0)` で生成して「あとは重力で落ち着く」のを待つアプローチは、過渡応答中に「空飛ぶ魚（エサを追って水面へ）」や「空中投下されるエサ」などの異常挙動を引き起こす。
**解決策:** リセット時も、初期セットアップと同様に、計算済みの平衡座標（Equilibrium Position）に強制配置する。

### 4. フォントパスの脆弱性
macOSのシステムフォントパスは絶対パスで指定すると脆い（OSバージョンや言語設定で英語名/日本語名が変わる）。
**解決策:** 複数の候補パス（英語名・日本語名）を探索し、失敗時は `pygame.font.match_font` でシステムフォントにフォールバックする堅牢なローダーを実装し、全描画箇所で共有する。
